<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>ESP32 Ultimate IDE</title>
    <script src="https://unpkg.com/blockly/blockly.min.js"></script>
    <script src="https://unpkg.com/blockly/javascript_compressed.js"></script>
    
    <style>
        body { margin: 0; display: flex; flex-direction: column; height: 100vh; font-family: sans-serif; }
        .panel { background: #2c3e50; color: white; padding: 10px; display: flex; gap: 10px; align-items: center; }
        #blocklyDiv { flex-grow: 1; width: 100%; }
        button { padding: 8px 15px; border-radius: 4px; border: none; cursor: pointer; font-weight: bold; }
        .btn-flash { background: #27ae60; color: white; }
        .btn-code { background: #34495e; color: white; border: 1px solid #7f8c8d; }
        #codeView { display: none; position: fixed; top: 50px; right: 10px; width: 40%; height: 80vh; 
                    background: #1e1e1e; color: #d4d4d4; padding: 15px; overflow: auto; z-index: 100; 
                    border-radius: 8px; box-shadow: 0 0 20px rgba(0,0,0,0.5); font-family: monospace; }
    </style>
</head>
<body>

<div class="panel">
    <button class="btn-flash" id="btnFlash">‚ö° –ü–†–û–®–ò–¢–¨</button>
    <button class="btn-code" id="btnViewCode">üìÑ –ö–û–î</button>
    <div id="status">–°—Ç–∞—Ç—É—Å: –ì–æ—Ç–æ–≤</div>
</div>

<div id="blocklyDiv"></div>
<div id="codeView"><pre id="codePre"></pre><button onclick="document.getElementById('codeView').style.display='none'">–ó–∞–∫—Ä—ã—Ç—å</button></div>

<xml id="toolbox" style="display:none">
    <category name="–õ–æ–≥–∏–∫–∞" colour="210">
        <block type="controls_if"></block>
        <block type="logic_compare"></block>
        <block type="logic_operation"></block>
        <block type="logic_boolean"></block>
    </category>
    <category name="–¶–∏–∫–ª—ã" colour="120">
        <block type="controls_repeat_ext"><value name="TIMES"><shadow type="math_number"><field name="NUM">10</field></shadow></value></block>
        <block type="controls_whileUntil"></block>
    </category>
    <category name="–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞" colour="230">
        <block type="math_number"></block>
        <block type="math_arithmetic"></block>
    </category>
    <category name="–¢–µ–∫—Å—Ç" colour="160">
        <block type="text"></block>
        <block type="esp32_serial_print"></block>
    </category>
    <category name="–í—Ä–µ–º—è" colour="65">
        <block type="esp32_delay"></block>
        <block type="esp32_millis"></block>
    </category>
    <sep></sep>
    <category name="–í—Ö–æ–¥—ã / –í—ã—Ö–æ–¥—ã" colour="20">
        <block type="esp32_digital_write"></block>
        <block type="esp32_digital_read"></block>
        <block type="esp32_analog_read"></block>
        <block type="esp32_pwm_write"></block>
    </category>
    <category name="–ü—Ä–µ—Ä—ã–≤–∞–Ω–∏—è" colour="0">
        <block type="esp32_interrupt"></block>
    </category>
    <category name="–°–µ–Ω—Å–æ—Ä—ã" colour="45">
        <block type="esp32_touch_read"></block>
        <block type="esp32_hall_read"></block>
        <block type="esp32_dht_read"></block>
    </category>
    <category name="–î–∏—Å–ø–ª–µ–∏" colour="200">
        <block type="esp32_oled_init"></block>
        <block type="esp32_oled_print"></block>
    </category>
    <category name="–ú–æ–¥—É–ª–∏ —Å–≤—è–∑–∏" colour="230">
        <block type="esp32_wifi_connect"></block>
        <block type="esp32_http_get"></block>
    </category>
    <sep></sep>
    <category name="–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ" colour="330" custom="VARIABLE"></category>
    <category name="–ú–∞—Å—Å–∏–≤—ã" colour="260">
        <block type="lists_create_with"></block>
    </category>
    <category name="–§—É–Ω–∫—Ü–∏–∏" colour="290" custom="PROCEDURE"></category>
</xml>

<script src="blocks.js"></script>
<script type="module" src="app.js"></script>

</body>
</html>
