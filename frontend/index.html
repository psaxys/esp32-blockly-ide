<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>ESP32 Blockly IDE</title>
    <script src="https://unpkg.com/blockly/blockly.min.js"></script>
    <script src="https://unpkg.com/blockly/javascript_compressed.js"></script>
    <style>
        body { margin: 0; display: flex; flex-direction: column; height: 100vh; font-family: sans-serif; }
        .nav { background: #1a252f; color: white; padding: 10px; display: flex; gap: 10px; align-items: center; }
        #blocklyDiv { flex-grow: 1; width: 100%; }
        #codeModal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 100; }
        .modal-body { background: #1e1e1e; color: #0f0; margin: 5% auto; width: 80%; height: 80%; padding: 20px; border-radius: 8px; overflow: auto; }
        pre { white-space: pre-wrap; word-wrap: break-word; }
    </style>
</head>
<body>

<div class="nav">
    <button id="btnFlash" style="background: #27ae60; color: white;">‚ö° –ü–†–û–®–ò–¢–¨</button>
    <button id="btnViewCode">üìÑ –ö–û–î</button>
    <span id="status">–°—Ç–∞—Ç—É—Å: –ì–æ—Ç–æ–≤</span>
</div>

<div id="blocklyDiv"></div>

<div id="codeModal">
    <div class="modal-body">
        <pre id="codeOutput"></pre>
        <button onclick="document.getElementById('codeModal').style.display='none'">–ó–ê–ö–†–´–¢–¨</button>
    </div>
</div>

<xml id="toolbox" style="display:none">
    <category name="–õ–æ–≥–∏–∫–∞" colour="210">
        <block type="controls_if"></block>
        <block type="logic_compare"></block>
    </category>
    <category name="ESP32 –Ø–¥—Ä–æ" colour="285">
        <block type="esp32_main_structure"></block>
        <block type="esp32_delay"></block>
        <block type="esp32_digital_write"></block>
        <block type="esp32_serial_print"></block>
        <block type="esp32_dht_read"></block>
    </category>
    <category name="–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞" colour="230">
        <block type="math_number"></block>
        <block type="math_arithmetic"></block>
    </category>
    <category name="–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ" colour="330" custom="VARIABLE"></category>
</xml>

<script src="blocks.js"></script>
<script type="module" src="app.js"></script>
</body>
</html>
